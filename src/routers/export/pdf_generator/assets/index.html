<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <!--  Own style file  -->
    <link rel="stylesheet" href="styles.css">
    <!--  Bootstrap 5.3  -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-aFq/bzH65dt+w6FI2ooMVUpc+21e0SRygnTpmBvdBgSdnuTN7QbdgL+OapgHtvPp" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-qKXV1j0HvMUeCBQ+QVp7JcfGl760yU08IQ+GpUo5hlbpg51QRiuqHAJz8+BrxE/N"
            crossorigin="anonymous"></script>

    <!--  python-variable defined css  -->
    <style>
        .ihc_arrow::before {
            content: '';
            position: relative;
            top: -4px;
            left: {{ bmi }}%;
            border: 6px solid transparent;
            border-top-color: #516EB4;
        }
    </style>
</head>

<body>
    <div class="container mt-5">
        <h1 class="title mb-4">{{name}}</h1>
        <div class="row justify-content-center user_data_block">
            <div class="col-5">
                <div class="row justify-content-center">
                    <div class="col-8 user_data_key text-center">Índice de masa corporal</div>
                </div>
                <div class="row justify-content-center mt-2">
                    <div class="col-3 ihc_circle mx-2 py-1 px-3">
                        <div class="row justify-content-center ihc_main_text">{{height}}</div>
                        <div class="row justify-content-center ihc_subtext">cm</div>
                    </div>
                    <div class="col-3 ihc_circle mx-2 py-1 px-3">
                        <div class="row justify-content-center ihc_main_text">{{weight}}</div>
                        <div class="row justify-content-center ihc_subtext">kg</div>
                    </div>
                </div>
                <div class="row justify-content-center mt-3 ihc_arrow">
                    <div class="progress" style="max-height: 5px; max-width: 75%; background-color: #A7B6D9">
                        <div role="progressbar" style="width: 25%"></div>
                        <div class="progress-bar" role="progressbar" style="width: 50%; background-color: #516EB4"></div>
                    </div>
                </div>
                <div class="row justify-content-center">
                    <div class="col text-center">
                        {{ groups.0 }}
                    </div>
                    <div class="col text-center">
                        {{ groups.1 }}
                    </div>
                    <div class="col text-center">
                        {{ groups.2 }}
                    </div>
                </div>
            </div>

            <div class="col-7">
                <div class="row">
                    <div>
                        <span class="user_data_key">Fecha de nacimiento:</span>
                        <span class="user_data_value">{{ text_age }}</span>
                    </div>
                </div>
                <div class="row mt-3">
                    <div>
                        <span class="user_data_key">Autodiagnósticos en el último mes:</span>
                        <span class="user_data_value">{{ last_month_predictions }}</span>
                    </div>
                </div>
                <div class="row mt-3">
                    <div>
                        <span class="user_data_key">Medicamentos activos:</span>
                        <span class="user_data_value">{{ medicines|length }}</span>
                    </div>
                </div>
                <div class="row mt-3">
                    <div>
                        <span class="user_data_key">Supervisores:</span>
                        <span class="user_data_value">{{ supervisors }}</span>
                    </div>
                </div>
            </div>
        </div>
        <div class="user_medicines_block">
            <h1 class="subtitle mb-4">Medicamentos activos</h1>
            {% if medicines %}
            {% for medicine in medicines %}
            <div class="no_jump_line mb-3 {{'medicine_block pt-3' if loop.index0 > 0 }}">
                <div class="row">
                    <div class="col">
                        <div class="medicine_title">{{ medicine.name }}</div>
                        <div class="medicine_text mt-2">{{ medicine.instructions }}</div>
                        <div class="medicine_text mt-2">{{ medicine.presentation }}, {{ medicine.dosis }} {{ medicine.dosis_unit }}</div>
                    </div>
                    <div class="col">
                        <div class="medicine_title text-center">Días</div>
                        <div class="mt-2 text-center">
                            {% if medicine.days %}
                                {% for day in medicine.days %}
                                {% if day.enabled %}
                                <span class="enabled_day">{{ day.day }}</span>
                                {% else %}
                                <span class="not_enabled_day">{{ day.day }}</span>
                                {% endif %}
                                {% endfor %}
                            {% else %}
                                {% if medicine.interval %}
                                    <span class="interval">Cada {{ medicine.interval }} días</span>
                                {% else %}
                                    <span class="when_needed">Cuando se necesita</span>
                                {% endif %}
                            {% endif %}
                        </div>
                        {% if medicine.hours %}
                        <div class="mt-2">
                            {% for hour in medicine.hours %}
                            <span class="hour">{{ hour }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}
                    </div>
                    <div class="col text-center">
                        <div class="medicine_title text-center">Avance del tratamiento</div>

                        <div class="d-flex justify-content-center">
                            {% if medicine.percentage %}
                            <div class="progress mt-2" style="width: 200px;">
                                <div class="progress-bar progress-bar-striped bg-color" role="progressbar" style="width: {{ medicine.percentage }}%" aria-valuenow="{{ medicine.percentage }}" aria-valuemin="0" aria-valuemax="100"></div>
                            </div>
                            {% else %}
                            <div class="progress mt-2" style="width: 200px;">
                                <div class="progress-bar progress-bar-striped bg-warning" role="progressbar" style="width: 100%" aria-valuenow="100" aria-valuemin="0" aria-valuemax="100">
                                    Sin fecha de fin
                                </div>
                            </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
            {% else %}
            <div class="no_jump_line mb-3 text-center">
                <div>
                    <div class="warning">No hay medicamentos activos</div>
                </div>
            </div>
            {% endif %}
        </div>
        <div class="user_measurements_block">
            <h1 class="subtitle mb-4">Mediciones en los últimos 30 días</h1>
            {% if measurements %}
            <div class="d-flex justify-content-center">
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Fecha</th>
                            <th>Tipo</th>
                            <th>Resultado</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for measurement in measurements %}
                        <tr>
                            <td>{{ measurement.date.strftime('%Y-%m-%d') }}</td>
                            <td>{{ measurement.type }}</td>
                            <td>{{ measurement.result }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <div class="no_jump_line mb-3 text-center">
                <div>
                    <div class="warning">No hay mediciones registradas en los últimos 30 días</div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</body>

</html>